<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pracpac">
<title>Basic Usage • pracpac</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Basic Usage">
<meta property="og:description" content="pracpac">
<meta property="og:image" content="https://signaturescience.github.io/pracpac/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pracpac</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/basic-usage.html">Basic Usage</a>
    <a class="dropdown-item" href="../articles/use-cases.html">Use Cases</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Basic Usage</h1>
            
      
      
      <div class="d-none name"><code>basic-usage.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>R packages are the fundamental units of reproducible code in R.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Hadley Wickham and Jenny Bryan. &lt;em&gt;R Packages
(2e)&lt;/em&gt;. &lt;a href="https://r-pkgs.org/" class="external-link uri"&gt;https://r-pkgs.org/&lt;/a&gt;.&lt;/p&gt;'><sup>1</sup></a> Docker is
a virtualization technology that can be used to bundle an application
and all its dependencies in a virtual container that can be distributed
and deployed to run reproducibly on any Windows, Linux or MacOS
operating system. When used in tandem, these tools can help developers
deliver software with an inherently reproducible set of dependencies,
including specific dependent R packages. An R package developer may
consider building a docker image that contains their R package. This
approach can be useful in various scenarios, one of which is a case
where the R package includes functions to pre- and post-process data
that is also processed by a domain-specific tool written in another
language (i.e., something that couldn’t be included as an R package
dependency).</p>
<p>We developed <code>pracpac</code> with a goal of providing intuitive
functions for developers to use custom R packages and Docker together.
The <code>pracpac</code> package is conceptually inspired by packages
like <code>devtools</code> and <code>usethis</code>, which dramatically
reduce the technical burden of R package development. With
<code>pracpac</code>, users can easily create templates of the necessary
files and directory structure to build a Docker image that contains
their R package and specific dependency packages, with versions
optionally frozen via <code>renv</code>.</p>
</div>
<div class="section level2">
<h2 id="terminology">Terminology<a class="anchor" aria-label="anchor" href="#terminology"></a>
</h2>
<p>It may be useful to clarify Docker terminology used throughout:</p>
<ul>
<li>
<strong>Image</strong>: Snapshot built to define <em>container</em>
contents</li>
<li>
<strong>Container</strong>: Instantiated <em>image</em> that can be
run on the host</li>
</ul>
<p>For more information on Docker installation, terminology, and usage
see <a href="https://docs.docker.com/" class="external-link">https://docs.docker.com/</a>.</p>
</div>
<div class="section level2">
<h2 id="using-pracpac">Using <code>pracpac</code><a class="anchor" aria-label="anchor" href="#using-pracpac"></a>
</h2>
<p>The <code>prapcac</code> package is designed to do two things:</p>
<ol style="list-style-type: decimal">
<li>Template files/directories for a Docker image containing an R
package</li>
<li>Build the Docker image</li>
</ol>
<p>These features are delivered in the <code><a href="../reference/use_docker.html">use_docker()</a></code> and
<code><a href="../reference/build_image.html">build_image()</a></code> functions.</p>
<div class="section level3">
<h3 id="use_docker">
<code>use_docker()</code><a class="anchor" aria-label="anchor" href="#use_docker"></a>
</h3>
<p>The <code>pracpac</code> package includes individual functions to add
a template Dockerfile, build the source of an R package to be added to
the Docker image, and define dependencies for that package in an
<code>renv</code> lock file. All files created are moved to the Docker
directory specified by the user, which as a default is set to a
<code>docker/</code> subdirectory of the R package. For convenience, the
<code>pracpac</code> functionality is wrapped into the
<code><a href="../reference/use_docker.html">use_docker()</a></code> function.</p>
<p>The example that follows uses the <code>hellow</code> R package that
ships with <code>pracpac</code>. With <code>pracpac</code> installed,
the <code>hellow</code> source code can be found with the following
command:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"hellow"</span>, package <span class="op">=</span> <span class="st">"pracpac"</span><span class="op">)</span></span></code></pre></div>
<p>To motivate the basic usage we will assume that the developer is
working within the <code>hellow</code> R project (i.e., with the working
directory at the package root):</p>
<pre><code>├── DESCRIPTION
├── LICENSE
├── LICENSE.md
├── NAMESPACE
├── R
│   └── hello.R
├── hellow.Rproj
└── man
    └── isay.Rd</code></pre>
<p>From the root of this directory, the developer could use
<code><a href="../reference/use_docker.html">use_docker()</a></code> to create the template for a Docker image that
contains the <code>hellow</code> R package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/use_docker.html">use_docker</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>├── DESCRIPTION
├── LICENSE
├── LICENSE.md
├── NAMESPACE
├── R
│   └── hello.R
├── docker
│   ├── Dockerfile
│   ├── hellow_0.1.0.tar.gz
│   └── renv.lock
├── hellow.Rproj
└── man
    └── isay.Rd</code></pre>
<p>With defaults set, this function will create a
<code>Dockerfile</code> with the following contents:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> rocker/r-ver:latest</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">## copy the renv.lock into the image</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> renv.lock /renv.lock</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">## install renv and biocmanager</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">Rscript</span> <span class="at">-e</span> <span class="st">'install.packages(c("renv","BiocManager"), repos="https://cloud.r-project.org")'</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">## set the renv path var to the renv lib</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="kw">ENV</span> RENV_PATHS_LIBRARY renv/library</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">## restore packages from renv.lock</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">Rscript</span> <span class="at">-e</span> <span class="st">'renv::restore(lockfile = "/renv.lock", repos = NULL)'</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">## copy in built R package</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="kw">COPY</span> hellow_0.1.0.tar.gz /hellow_0.1.0.tar.gz</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">## run script to install built R package from source</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="kw">RUN</span> <span class="ex">Rscript</span> <span class="at">-e</span> <span class="st">"install.packages('/hellow_0.1.0.tar.gz', type='source', repos=NULL)"</span></span></code></pre></div>
<p>And an <code>renv.lock</code> with the dependencies of
<code>hellow</code> (in this case just the <code>praise</code>
package):</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"R"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"Version"</span><span class="fu">:</span> <span class="st">"4.0.2"</span><span class="fu">,</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"Repositories"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"Name"</span><span class="fu">:</span> <span class="st">"CRAN"</span><span class="fu">,</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"URL"</span><span class="fu">:</span> <span class="st">"https://cran.rstudio.com"</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"Packages"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"praise"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"Package"</span><span class="fu">:</span> <span class="st">"praise"</span><span class="fu">,</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"Version"</span><span class="fu">:</span> <span class="st">"1.0.0"</span><span class="fu">,</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"Source"</span><span class="fu">:</span> <span class="st">"Repository"</span><span class="fu">,</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"Repository"</span><span class="fu">:</span> <span class="st">"CRAN"</span><span class="fu">,</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"Hash"</span><span class="fu">:</span> <span class="st">"a555924add98c99d2f411e37e7d25e9f"</span><span class="fu">,</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"Requirements"</span><span class="fu">:</span> <span class="ot">[]</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>The <code><a href="../reference/use_docker.html">use_docker()</a></code> defaults will produce the behavior
described above. However, the functionality can be customized further.
For example, the user can optionally specify a use case to create
variants of template files (described in more detail in other
vignettes). Another option is to specify an <code>img_path</code>
defining where the files used to build the Docker image should be
written, which may be useful for developers who prefer not to build
images within the R package root. The following shows how this could be
used to write the Docker template files to the directory above the
package root:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/use_docker.html">use_docker</a></span><span class="op">(</span>pkg_path <span class="op">=</span> <span class="st">"."</span>, img_path <span class="op">=</span> <span class="st">"../."</span><span class="op">)</span></span></code></pre></div>
<pre><code>├── Dockerfile
├── hellow
│   ├── DESCRIPTION
│   ├── LICENSE
│   ├── LICENSE.md
│   ├── NAMESPACE
│   ├── R
│   │   └── hello.R
│   ├── hellow.Rproj
│   └── man
│       └── isay.Rd
├── hellow_0.1.0.tar.gz</code></pre>
<p>For a full list of options see <code><a href="../reference/use_docker.html">?use_docker</a></code>.</p>
</div>
<div class="section level3">
<h3 id="build_image">
<code>build_image()</code><a class="anchor" aria-label="anchor" href="#build_image"></a>
</h3>
<p>The <code><a href="../reference/use_docker.html">use_docker()</a></code> function includes an option to
“build_image”. By default this parameter is set to <code>FALSE</code>.
The <code>pracpac</code> templates are likely to require some editing by
the developer. However, after editing the <code>Dockerfile</code> and
any constituent files to be added the user can call
<code><a href="../reference/build_image.html">build_image()</a></code> to build the Docker image:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/build_image.html">build_image</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Note that if the user has specified a different <code>img_path</code>
in <code><a href="../reference/use_docker.html">use_docker()</a></code>, then the same path needs to be used with
<code><a href="../reference/build_image.html">build_image()</a></code>.</p>
<p>By default the image will be built and tagged with the name of the R
package and a “latest” and version suffix:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></span><span class="op">(</span><span class="st">"docker images"</span><span class="op">)</span></span></code></pre></div>
<pre><code>hellow                            0.1.0        e1a9bc2ebbb5   15 seconds ago   828MB
hellow                            latest       e1a9bc2ebbb5   15 seconds ago   828MB</code></pre>
<p>The tagging scheme can be altered with the “tag” argument. The
<code><a href="../reference/build_image.html">build_image()</a></code> function also includes a parameter to
leverage the Docker build “cache” feature. For more details see
<code><a href="../reference/build_image.html">?build_image</a></code>. To use additional build parameters the user
can call the Docker daemon directly on the host or use a client like <a href="https://CRAN.R-project.org/package=stevedore" class="external-link"><code>stevedore</code></a>.</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Stephen Turner, VP Nagraj.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
